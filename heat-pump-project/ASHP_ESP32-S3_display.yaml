esphome:
  name: ashp-display
  friendly_name: "ASHP Display"
  min_version: 2025.05.2
  platformio_options:
    build_unflags: -Werror=all
    board_build.flash_mode: dio
    build_flags:
      - -DBOARD_HAS_PSRAM
    board_build.esp-idf.memory_type: qio_opi
    board_upload.maximum_ram_size: 524288
    board_build.flash_size: 8MB
  on_boot:
    priority: -100  # Run after everything else is initialized
    then:
      - script.execute: wake_backlight
esp32:
  board: esp32-s3-devkitc-1
  variant: esp32s3
  flash_size: 8MB
  cpu_frequency: 240MHz
  framework:
    type: esp-idf
    sdkconfig_options:
      CONFIG_ESP32S3_DATA_CACHE_64KB: "y"
      CONFIG_ESPTOOLPY_FLASHSIZE_8MB: "y"
      CONFIG_FREERTOS_HZ: "1000"
      CONFIG_ESP_DEFAULT_CPU_FREQ_MHZ_240: y
      CONFIG_ESPTOOLPY_FLASHMODE_QIO: y
      CONFIG_ESPTOOLPY_FLASHFREQ_80M: y
      CONFIG_SPIRAM_MODE_OCT: y
      CONFIG_IDF_EXPERIMENTAL_FEATURES: y
      CONFIG_SPIRAM_SPEED_80M: y
      CONFIG_SPIRAM_FETCH_INSTRUCTIONS: y
      CONFIG_SPIRAM_RODATA: y
      CONFIG_ESP32S3_DATA_CACHE_LINE_64B: y
    advanced:
      enable_idf_experimental_features: False

# host:
#   mac_address: "de:ad:be:ef:fe:ed"

logger:
  level: DEBUG
  hardware_uart: UART0
  baud_rate: 0
  logs:
    safe_mode: INFO
    debug: INFO
    main: INFO
    esp-idf: WARN
    esp32.preferences: INFO
    wifi: WARN
    api: WARN
    sntp: WARN
    i2c: WARN
    i2c.idf: WARN
    ch422g: WARN
    touchscreen: WARN
    gt911.touchscreen: WARN
    switch: WARN
    sensor: WARN
    binary_sensor: WARN
    text_sensor: WARN
    light: WARN
    select: WARN
    homeassistant.sensor: WARN
    homeassistant.binary_sensor: WARN
    homeassistant.text_sensor: WARN
    template.switch: WARN
    script: WARN
    http_request: WARN
    http_request.idf: WARN
    online_image: WARN
    number: WARN

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password

http_request:
  verify_ssl: false

debug:

api:
  encryption:
    key: !secret api_encryption_key

ota:
  - platform: esphome
    password: !secret ota_password

psram:
  mode: octal
  speed: 80MHz

ch422g:
  - id: io_ex

i2c:
  sda: 8
  scl: 9
  frequency: 400kHz
  scan: false
  id: bus_a

light:
  - platform: binary
    name: "Display Backlight"
    id: display_backlight
    output: backlight_gpio
    restore_mode: ALWAYS_ON

globals:
  - id: backlight_active
    type: bool
    restore_value: no
    initial_value: 'true'

script:
  - id: backlight_timeout
    then:
      - if:
          condition:
            lambda: 'return id(backlight_active);'
          then:
            - lambda: |-
                ESP_LOGI("backlight", "Display timeout - turning off backlight");
                id(backlight_active) = false;
            - light.turn_off: display_backlight

  - id: wake_backlight
    mode: restart  # Restart if already running (resets timer)
    then:
      # Turn on backlight if it was off
      - if:
          condition:
            lambda: 'return !id(backlight_active);'
          then:
            - lambda: |-
                ESP_LOGI("backlight", "Waking display from touch");
                id(backlight_active) = true;
            - light.turn_on: display_backlight
      
      # Wait 5 minutes, then timeout
      - delay: 300s
      - script.execute: backlight_timeout


safe_mode:

button:
  - platform: safe_mode
    name: "Device Restart (Safe mode)"
    id: id_button_device_restart_safe_mode
    icon: mdi:restart-alert

output:
  - platform: gpio
    id: backlight_gpio
    pin:
      ch422g: io_ex
      number: 0
      mode: output
      inverted: false

# Touchscreen (hardware)
touchscreen:
  platform: gt911
  address: 0x5D
  id: my_touchscreen
  interrupt_pin: 4
  reset_pin:
    ch422g: io_ex
    number: 1
  on_touch:
    - script.execute: wake_backlight
# Display (hardware)
display:
  - platform: rpi_dpi_rgb
    id: device_display
    update_interval: never
    auto_clear_enabled: false
    color_order: RGB
    pclk_frequency: 21MHz
    dimensions:
      width: 800
      height: 480
    reset_pin:
      ch422g: io_ex
      number: 2
    de_pin:
      number: 5
    hsync_pin:
      number: 46
      ignore_strapping_warning: true
    vsync_pin:
      number: 3
      ignore_strapping_warning: true
    pclk_pin: 7
    pclk_inverted: true
    hsync_back_porch: 16
    hsync_front_porch: 210
    hsync_pulse_width: 4
    vsync_back_porch: 13
    vsync_front_porch: 4
    vsync_pulse_width: 4
    data_pins:
      red: [1, 2, 42, 41, 40]
      blue: [14, 38, 18, 17, 10]
      green: [39, 0, 45, 48, 47, 21]

# UART/Modbus (hardware—keep wiring as per your device)
uart:
  id: mod_bus
  tx_pin: GPIO15
  rx_pin: GPIO16
  baud_rate: 19200
  stop_bits: 1
  parity: NONE
  data_bits: 8

modbus:
  id: modbus1
  uart_id: mod_bus

modbus_controller:
  id: aerona3
  address: 1
  modbus_id: modbus1
  update_interval: 10s
  command_throttle: 200ms

# Bring in your Modbus controller and register maps (adjust paths)
binary_sensor: !include includes/modbus_binary_sensors.yaml
switch: !include includes/modbus_switches.yaml
number: !include includes/modbus_numbers.yaml
sensor: !include includes/modbus_sensors.yaml

# Fonts and assets
font:
  - file: 'fonts/FA7-Free-Solid-900.otf'
    id: fa_20
    size: 20
    bpp: 4
    glyphs: ["\uF053", "\uF054", "\uF015", "\uF1EB"]

  - file: "fonts/excelate.ttf"
    id: excelate_24
    size: 24
    bpp: 4

  - file: "fonts/excelate.ttf"
    id: excelate_18
    size: 18
    bpp: 4

image:
  - file: "images/aerona3.png"
    id: aerona_heat_pump_img
    type: RGB565
    resize: 340x440
    # Omit transparency to avoid edge artifacts on hardware
    transparency: alpha_channel

# LVGL UI (three pages + top-layer)
lvgl:
  displays: [device_display]
  touchscreens: [my_touchscreen]
  buffer_size: 25%
  log_level: INFO
  color_depth: 16
  byte_order: big_endian

  theme:
    label:
      text_color: 0xFFFFFF
    button:
      bg_color: 0x2F8CD8
      bg_grad_color: 0x005782
      bg_grad_dir: VER
      bg_opa: COVER
      border_color: 0x0077b3
      border_width: 1
      text_color: 0xFFFFFF
      pressed:
        bg_color: 0x006699
        bg_grad_color: 0x00334d
    buttonmatrix:
      bg_opa: TRANSP
      border_width: 0
      text_color: 0xFFFFFF
      items:
        bg_color: 0x2F8CD8
        bg_grad_color: 0x005782
        bg_grad_dir: VER
        bg_opa: COVER
        border_color: 0x0077b3
        border_width: 1
        text_color: 0xFFFFFF
    switch:
      bg_color: 0xC0C0C0
      bg_grad_color: 0xB0B0B0
      bg_grad_dir: VER
      bg_opa: COVER
      checked:
        bg_color: 0x1D5F96
        bg_grad_color: 0x03324A
        bg_grad_dir: VER
        bg_opa: COVER
      knob:
        bg_color: 0xFFFFFF
        bg_grad_color: 0xC0C0C0
        bg_grad_dir: VER
        bg_opa: COVER

  style_definitions:
    - id: header_footer
      bg_color: 0x2F8CD8
      bg_grad_color: 0x005782
      bg_grad_dir: VER
      bg_opa: COVER
      border_opa: TRANSP
      radius: 0
      pad_all: 0
      pad_row: 0
      pad_column: 0
      border_color: 0x0077b3
      text_color: 0xFFFFFF
      width: 100%
      height: 30

  top_layer:
    widgets:
      - buttonmatrix:
          align: bottom_mid
          styles: header_footer
          pad_all: 0
          outline_width: 0
          id: nav_bar
          items:
            styles: header_footer
          rows:
            - buttons:
              - id: page_prev
                text: "\uF053"
                on_press:
                  then:
                    lvgl.page.previous:
              - id: page_home
                text: "\uF015"
                on_press:
                  then:
                    lvgl.page.show: home_page
              - id: page_next
                text: "\uF054"
                on_press:
                  then:
                    lvgl.page.next:
      - label:
          text: "\uF1EB"
          id: lbl_hastatus
          hidden: true
          align: top_right
          x: -6
          y: 6
          text_align: right
          text_font: fa_20
          text_color: 0xFFFFFF

  pages:

    - id: home_page
      widgets:
        - obj:
            width: 800
            height: 480
            bg_color: 0x464B55
            border_width: 0
            pad_all: 0                 # small global inset to avoid edge seams
            widgets:
              - obj:
                  align: TOP_MID
                  styles: header_footer
                  widgets:
                    - label:
                        text: "Grant Aerona3"
                        align: CENTER
                        text_align: CENTER
                        text_color: 0xFFFFFF

              # Image placed directly, minimal inset, no vertical offset
              - image:
                  id: aerona_image
                  src: aerona_heat_pump_img
                  align: LEFT_MID
                  x: 12
                  y: 10
                  width: 340
                  height: 440
                  border_width: 0

              # Branding block on the right, independent of the image
              - obj:
                  align: RIGHT_MID
                  x: 0
                  y: 0
                  width: SIZE_CONTENT
                  height: SIZE_CONTENT
                  bg_opa: TRANSP
                  border_opa: TRANSP
                  pad_all: 6
                  widgets:
                    - label:
                        id: heatalizer_label
                        text: "Heatalizer"
                        align: TOP_LEFT
                        x: 0
                        y: 0
                        text_font: excelate_24
                        text_color: 0xFFFFFF

                    - label:
                        id: heatalizer_3000_label
                        text: "3000"
                        align_to:
                          id: heatalizer_label
                          align: OUT_RIGHT_MID   # keep to the right of the word
                          x: -20                   # modest spacing
                          y: 20                    # slight drop for a badge feel
                        text_font: excelate_18
                        text_color: 0xFFC107



    - id: current_operation_page
      widgets:
        - obj:
            width: 800
            height: 480
            bg_color: 0x464B55
            border_width: 0
            pad_all: 0
            widgets:
              # Title bar
              - obj:
                  align: TOP_MID
                  styles: header_footer
                  widgets:
                    - label:
                        text: "Current Operation"
                        align: CENTER
                        text_align: CENTER
                        text_color: 0xFFFFFF
              # Left-side container with two aligned gauges (Power kW + Compressor Hz)
              - obj:
                  id: temp_container1
                  align: LEFT_MID
                  x: 0
                  y: 0
                  width: 200
                  height: 400
                  bg_color: 0x535966
                  border_width: 0
                  pad_all: 10
                  widgets:
                    - label:
                        text: "Flow Temp"
                        align: TOP_MID
                        y: 20
                        text_font: montserrat_16
                        text_color: 0xFFFFFF
                    - label:
                        id: flow_temp_value
                        text: "--°C"
                        align: TOP_MID
                        y: 45
                        text_font: montserrat_24
                        text_color: 0x33A1FF
                    - label:
                        text: "Return Temp"
                        align: TOP_MID
                        y: 80
                        text_font: montserrat_16
                        text_color: 0xFFFFFF  
                    - label:
                        id: return_temp_value
                        text: "--°C"
                        align: TOP_MID
                        y: 115
                        text_font: montserrat_24
                        text_color: 0x33A1FF     
                    - label:
                        text: "Outdoor Temp"
                        align: TOP_MID
                        y: 150
                        text_font: montserrat_16
                        text_color: 0xFFFFFF
                    - label:
                        id: outdoor_temp_value
                        text: "--°C"
                        align: TOP_MID
                        y: 185
                        text_font: montserrat_24
                        text_color: 0xFF9933
                    - label:
                        text: "Max Flow Temp"
                        align: TOP_MID
                        y: 220
                        text_font: montserrat_16
                        text_color: 0xFFFFFF
                    - label:
                        id: set_max_flow_temp_value
                        text: "--°C"
                        align: TOP_MID
                        y: 255
                        text_font: montserrat_24
                        text_color: 0x33A1FF 
              - obj:
                  id: op_center_container
                  align: CENTER
                  x: 10
                  y: 0
                  width: 280
                  height: 400            # fits between 30px header and 30px footer with some margin
                  bg_color: 0x535966
                  border_width: 0
                  pad_all: 10            # smaller padding to maximize inner space
                  widgets:
                    # ---------- Power gauge (0..6 kW) ----------
                    - label:
                        text: "Power"
                        align: TOP_MID
                        x: 0
                        y: 0
                        text_font: montserrat_16
                        text_color: 0xFFFFFF

                    - obj:
                        id: power_gauge_box
                        align: TOP_MID
                        x: 0
                        y: 22
                        width: 240
                        height: 160
                        bg_color: 0x2B2F36         # darker box for contrast
                        border_width: 0
                        pad_all: 6
                        widgets:
                          - meter:
                              id: power_meter
                              height: 100%
                              width: 100%
                              border_width: 0
                              bg_opa: TRANSP
                              align: CENTER
                              scales:
                                # Background arcs for top half, 10x resolution (0..60 = 0..6 kW)
                                - range_from: 0
                                  range_to: 60
                                  angle_range: 180
                                  rotation: 180
                                  ticks:
                                    count: 0
                                  indicators:
                                    - arc:
                                        color: 0x2468B3     # richer blue low 
                                        r_mod: 12           # slightly farther from center to avoid overlap seams
                                        width: 22           # narrower arc bands
                                        start_value: 0
                                        end_value: 45
                                    - arc:
                                        color: 0xE0621A     # richer orange high
                                        r_mod: 12
                                        width: 22
                                        start_value: 45
                                        end_value: 90
                                # Needle scale (no ticks)
                                - range_from: 0
                                  range_to: 90
                                  angle_range: 180
                                  rotation: 180
                                  ticks:
                                    count: 0
                                  indicators:
                                    - line:
                                        id: power_needle
                                        width: 5
                                        color: 0xFFC107    # warm amber needle (slightly brighter than label)
                                        r_mod: 8           # length: larger than hub, shorter than arcs for aesthetic
                                        value: 0
                          # Center cover
                          - obj:
                              height: 16          # diameter of the dot
                              width: 16
                              radius: 8           # makes it a circle
                              align: CENTER
                              y: 40                
                              border_width: 0
                              pad_all: 0
                              bg_color: 0xFFD54F
                          # Value label
                          - label:
                              id: power_text
                              text_font: montserrat_20
                              align: CENTER
                              y: 56
                              text: "--.- kW"
                              text_color: 0xFFD54F

                    # ---------- Compressor frequency gauge (0..90 Hz) ----------
                    - label:
                        text: "Compressor Frequency"
                        align: TOP_MID 
                        x: 0
                        y: 196
                        text_font: montserrat_16
                        text_color: 0xFFFFFF

                    - obj:
                        id: freq_gauge_box
                        align: TOP_MID
                        x: 0
                        y: 218
                        width: 240
                        height: 160
                        bg_color: 0x30343B
                        border_width: 0
                        pad_all: 6
                        widgets:
                          - meter:
                              id: freq_meter
                              height: 100%
                              width: 100%
                              border_width: 0
                              bg_opa: TRANSP
                              align: CENTER
                              scales:
                                # Background arcs for 0..90 Hz top half
                                - range_from: 0
                                  range_to: 90
                                  angle_range: 180
                                  rotation: 180
                                  ticks:
                                    count: 0
                                  indicators:
                                    - arc:
                                        color: 0x1F5AA6     # deep blue
                                        r_mod: 10
                                        width: 26
                                        start_value: 0
                                        end_value: 45
                                    - arc:
                                        color: 0xD64C0C     # deep orange
                                        r_mod: 10
                                        width: 26
                                        start_value: 45
                                        end_value: 90
                                # Needle scale (no ticks)
                                - range_from: 0
                                  range_to: 90
                                  angle_range: 180
                                  rotation: 180
                                  ticks:
                                    count: 0
                                  indicators:
                                    - line:
                                        id: freq_needle
                                        width: 5
                                        color: 0xFFD54F      # amber needle
                                        r_mod: 8
                                        value: 0
                          # Center cover
                          - obj:
                              height: 16          # diameter of the dot
                              width: 16
                              radius: 8           # makes it a circle
                              align: CENTER       # center of the gauge
                              y: 40 
                              border_width: 0
                              pad_all: 0
                              bg_color: 0xFFD54F 
                          # Value label
                          - label:
                              id: freq_text
                              text_font: montserrat_20
                              align: CENTER
                              y: 56
                              text: "-- Hz"
                              text_color: 0xFFD54F


              - obj:
                  id: temp_container
                  align: RIGHT_MID
                  x: 0
                  y: 0
                  width: 200
                  height: 400
                  bg_color: 0x535966
                  border_width: 0
                  pad_all: 10
                  widgets:
                    - label:
                        text: "DHW Tank Temp"
                        align: TOP_MID
                        y: 20
                        text_font: montserrat_16
                        text_color: 0xFFFFFF
                    - label:
                        id: dhw_temp_value
                        text: "--°C"
                        align: TOP_MID
                        y: 45
                        text_font: montserrat_24
                        text_color: 0x33A1FF
                    - label:
                        text: "Water Pump Speed"
                        align: TOP_MID
                        y: 80
                        text_font: montserrat_16
                        text_color: 0xFFFFFF  
                    - label:
                        id: water_pump_speed_value
                        text: "--rpm"
                        align: TOP_MID
                        y: 115
                        text_font: montserrat_24
                        text_color: 0x33A1FF     
                    - label:
                        text: "Fan Speed"
                        align: TOP_MID
                        y: 150
                        text_font: montserrat_16
                        text_color: 0xFFFFFF
                    - label:
                        id: fan_speed_value
                        text: "--rpm"
                        align: TOP_MID
                        y: 185
                        text_font: montserrat_24
                        text_color: 0xFF9933
                    - label:
                        text: "DischargeTemp"
                        align: TOP_MID
                        y: 220
                        text_font: montserrat_16
                        text_color: 0xFFFFFF
                    - label:
                        id: discharge_temp_value
                        text: "--°C"
                        align: TOP_MID
                        y: 255
                        text_font: montserrat_24
                        text_color: 0x33A1FF         
             



    - id: control_page
      widgets:
        - obj:
            width: 800
            height: 480
            bg_color: 0x464B55
            border_width: 0
            pad_all: 0
            widgets:
              # Title bar
              - obj:
                  align: TOP_MID
                  styles: header_footer
                  widgets:
                    - label:
                        text: "Control Page"
                        align: CENTER
                        text_align: CENTER
                        text_color: 0xFFFFFF

              # Max Flow dial (left)
              - obj:
                  id: max_dial_container
                  align: LEFT_MID
                  x: 40
                  y: 0
                  width: 300
                  height: 300
                  bg_color: 0x2B2F36     # deeper slate for better contrast
                  border_width: 0
                  pad_all: 15
                  widgets:
                    - label:
                        text: "Set Max Flow Temp"
                        align: TOP_MID
                        y: 10
                        text_font: montserrat_16
                        text_color: 0xFFFFFF

                    # Dial arcs (top semicircle) + needle
                    - arc:
                        id: max_temp_dial
                        align: CENTER
                        y: 15
                        width: 200
                        height: 200
                        min_value: 20
                        max_value: 65
                        value: 45
                        rotation: 0
                        start_angle: 135
                        end_angle: 45
                        arc_color: 0x2468B3    # richer blue outline
                        arc_width: 14
                        adjustable: true
                        on_value:
                          - logger.log:
                              format: "Max dial moving: %.1f"
                              args: [ 'x' ]
                          - lvgl.label.update:
                              id: max_temp_dial_label
                              text:
                                format: "%.0f°C"
                                args: [ 'x' ]
                        on_release:
                          - homeassistant.action:
                              action: number.set_value
                              data:
                                entity_id: number.set_max_flow_temp
                                value: !lambda return x;

                    # Dial value label pushed down slightly
                    - label:
                        id: max_temp_dial_label
                        align: BOTTOM_MID
                        y: 0
                        text: "45°C"
                        text_font: montserrat_32
                        text_color: 0xFFD54F    # softer amber for hierarchy

              # Min Flow dial (right)
              - obj:
                  id: min_dial_container
                  align: RIGHT_MID
                  x: -40
                  y: 0
                  width: 300
                  height: 300
                  bg_color: 0x2B2F36
                  border_width: 0
                  pad_all: 15
                  widgets:
                    - label:
                        text: "Set Min Flow Temp"
                        align: TOP_MID
                        y: 10
                        text_font: montserrat_16
                        text_color: 0xFFFFFF

                    # Dial arcs + needle (same geometry)
                    - arc:
                        id: min_temp_dial
                        align: CENTER
                        y: 15
                        width: 200
                        height: 200
                        min_value: 20
                        max_value: 65
                        value: 45
                        rotation: 0
                        start_angle: 135
                        end_angle: 45
                        arc_color: 0x2468B3
                        arc_width: 14
                        adjustable: true
                        on_value:
                          - logger.log:
                              format: "Min dial moving: %.1f"
                              args: [ 'x' ]
                          - lvgl.label.update:
                              id: min_temp_dial_label
                              text:
                                format: "%.0f°C"
                                args: [ 'x' ]
                        on_release:
                          - homeassistant.action:
                              action: number.set_value
                              data:
                                entity_id: number.set_min_flow_temp
                                value: !lambda return x;

                    # Dial value label pushed down slightly
                    - label:
                        id: min_temp_dial_label
                        align: BOTTOM_MID
                        y: 0
                        text: "45°C"
                        text_font: montserrat_32
                        text_color: 0xFFD54F

              # Weather comp switch
              - switch: 
                  id: lv_sw_weather_comp
                  align: BOTTOM_MID
                  y: -60
                  width: 90
                  height: 40
                  bg_color: 2201331
                  indicator: 
                    bg_color: 9159498
                    checked:
                      bg_color: 9159498

                  on_click:
                    - if:
                        condition:
                          lambda: 'return id(weather_comp).state;'
                        then:
                          - switch.turn_off: weather_comp  
                        else:
                          - switch.turn_on: weather_comp
            
              - label:
                  text: "Weather Compensation"
                  align: BOTTOM_MID
                  y: -40 
                  text_font: montserrat_16
                  text_color: 0xFFFFFF


    - id: fixed_control_page
      widgets:
        - obj:
            width: 800
            height: 480
            bg_color: 0x464B55
            border_width: 0
            pad_all: 0
            widgets:
              # Title bar
              - obj:
                  align: TOP_MID
                  styles: header_footer
                  widgets:
                    - label:
                        text: "Fixed Flow Rate"
                        align: CENTER
                        text_align: CENTER
                        text_color: 0xFFFFFF

              # Max Flow dial (left)
              - obj:
                  id: fixed_dial_container
                  align: CENTER
                  x: 0
                  y: 0
                  width: 300
                  height: 300
                  bg_color: 0x2B2F36     # deeper slate for better contrast
                  border_width: 0
                  pad_all: 15
                  widgets:
                    - label:
                        text: "Set Fixed Flow Temp"
                        align: TOP_MID
                        y: 10
                        text_font: montserrat_16
                        text_color: 0xFFFFFF

                    # Dial arcs (top semicircle) + needle
                    - arc:
                        id: fixed_temp_dial
                        align: CENTER
                        y: 15
                        width: 200
                        height: 200
                        min_value: 20
                        max_value: 65
                        value: 45
                        rotation: 0
                        start_angle: 135
                        end_angle: 45
                        arc_color: 0x2468B3    # richer blue outline
                        arc_width: 14
                        adjustable: true
                        on_value:
                          - logger.log:
                              format: "Fixed dial moving: %.1f"
                              args: [ 'x' ]
                          - lvgl.label.update:
                              id: fixed_temp_dial_label
                              text:
                                format: "%.0f°C"
                                args: [ 'x' ]
                        on_release:
                          - homeassistant.action:
                              action: number.set_value
                              data:
                                entity_id: number.set_fixed_flow_temp
                                value: !lambda return x;

                    # Dial value label pushed down slightly
                    - label:
                        id: fixed_temp_dial_label
                        align: BOTTOM_MID
                        y: 0
                        text: "45°C"
                        text_font: montserrat_32
                        text_color: 0xFFD54F    # softer amber for hierarchy
